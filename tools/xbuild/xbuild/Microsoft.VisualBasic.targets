<Project xmlns="http://schemas.microsoft.com/developer/msbuild/2003">

	<PropertyGroup>
		<DefaultLanguageSourceExtension>.vb</DefaultLanguageSourceExtension>
		<Language>VB</Language>
	</PropertyGroup>

	<PropertyGroup>
		<FinalDefineConstants>CONFIG=&quot;$(Configuration)&quot;</FinalDefineConstants>
		<FinalDefineConstants Condition=" '$(DefineDebug)' == 'true' ">$(FinalDefineConstants),DEBUG=-1</FinalDefineConstants>
		<FinalDefineConstants Condition=" '$(DefineTrace)' == 'true' ">$(FinalDefineConstants),TRACE=-1</FinalDefineConstants>
		<FinalDefineConstants Condition=" '$(MyType)' != '' ">$(FinalDefineConstants),_MyType=&quot;$(MyType)&quot;</FinalDefineConstants>
		<FinalDefineConstants Condition=" '$(Platform)' != '' ">$(FinalDefineConstants),PLATFORM=&quot;$(Platform)&quot;</FinalDefineConstants>
		<FinalDefineConstants Condition=" '$(Platform)' == '' ">$(FinalDefineConstants),PLATFORM=&quot;AnyCPU&quot;</FinalDefineConstants>
		<FinalDefineConstants Condition=" '$(DefineConstants)' != '' ">$(FinalDefineConstants),$(DefineConstants)</FinalDefineConstants>

		<_NoWarnings Condition=" '$(WarningLevel)' == '0' ">true</_NoWarnings>
		<_NoWarnings Condition=" '$(WarningLevel)' == '1' ">false</_NoWarnings>

		<DebugSymbols Condition=" '$(DebugType)' == 'none' ">false</DebugSymbols>
		<DebugType    Condition=" '$(DebugType)' == 'none' "></DebugType>
	</PropertyGroup>

	<ItemGroup>
		<DocFileItem Include="$(DocumentationFile)"  Condition="'$(DocumentationFile)'!=''"/>
	</ItemGroup>

	<Target
		Name="CoreCompile"
		Inputs="@(Compile)"
		Outputs="$(OutputPath)$(AssemblyName)$(TargetExt)"
	>

		<Vbc
			AdditionalLibPaths="$(AdditionalLibPaths)"
			AddModules="@(AddModules)"
			BaseAddress="$(BaseAddress)"          
			CodePage="$(CodePage)"
			DebugType="$(DebugType)"
			DefineConstants="$(FinalDefineConstants)"
			DelaySign="$(DelaySign)"
			DisabledWarnings="$(NoWarn)"
			DocumentationFile="@(DocFileItem)"
			EmitDebugInformation="$(DebugSymbols)"
			ErrorReport="$(ErrorReport)"
			FileAlignment="$(FileAlignment)"
			GenerateDocumentation="$(GenerateDocumentation)"
			Imports="@(Import)"
			KeyContainer="$(KeyContainerName)"
			KeyFile="$(KeyOriginatorFile)"
			MainEntryPoint="$(StartupObject)"
			NoConfig="true"
			NoStandardLib="$(NoStdLib)"
			NoWarnings="$(_NoWarnings)"
			Optimize="$(Optimize)"
			OptionCompare="$(OptionCompare)"
			OptionExplicit="$(OptionExplicit)"
			OptionStrict="$(OptionStrict)"
			OptionStrictType="$(OptionStrictType)" 
			OutputAssembly="$(OutputPath)$(AssemblyName)$(TargetExt)"
			Platform="$(PlatformTarget)"
			References="@(ReferencePath)"
			RemoveIntegerChecks="$(RemoveIntegerChecks)"
			ResponseFiles="$(CompilerResponseFile)"
			RootNamespace="$(RootNamespace)"
			SdkPath="$(FrameworkPathOverride)"
			Sources="@(Compile)"
			TargetCompactFramework="$(TargetCompactFramework)"
			TargetType="$(OutputType)"
			TreatWarningsAsErrors="$(TreatWarningsAsErrors)"
			UseHostCompilerIfAvailable="$(UseHostCompilerIfAvailable)"
			Utf8Output="$(Utf8Output)"
			Verbosity="$(VbcVerbosity)"
			WarningsAsErrors="$(WarningsAsErrors)"
			WarningsNotAsErrors="$(WarningsNotAsErrors)"
			Win32Icon="$(ApplicationIcon)"
			Win32Resource="$(Win32Resource)"
		/>

		<!--
			Resources="@(ManifestResourceWithNoCulture);@(ManifestNonResxWithNoCultureOnDisk);@(CompiledLicenseFile)"
			ToolPath="$(VbcToolPath)"

		-->

	</Target>

	<Import Project="Microsoft.Common.targets" />

</Project>
