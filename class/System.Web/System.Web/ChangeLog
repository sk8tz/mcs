2005-12-08 Robert Jordan  <robertj@gmx.net> 

	* MimeTypes.cs: added entry for "jpg".

2005-12-07 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: only read up to content-length when provided. Patch
	by Peter Teichman.

2005-12-06 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpCookie.cs: fixed the set_Secure. Closes bug #76906.

2005-11-28 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponseStream.cs: flush the filter stream before closing.
	Patch by Geir Bergum that fixes bug #76753.

2005-11-28  Chris Toshok  <toshok@ximian.com>

	* HttpContext.cs (Profile): remove the #if false from around this,
	as we now have the ProfileBase type.
	(GetConfig): add CONFIGURATION_2_0 version.
	(GetSection): add CONFIGURATION_2_0 version.

2005-11-28  Chris Toshok  <toshok@ximian.com>

	* TraceManager.cs (..ctor): CONFIGURATION_2_0 work.

	* QueueManager.cs (..ctor): CONFIGURATION_2_0 work.

	* HttpRequest.cs (AnonymousID): add 2.0 property.
	(MakeInputStream): CONFIGURATION_2_0 work.

	* HttpApplication.cs (InitOnce): change around the
	CONFIGURATION_2_0 stuff since we need additional Culture foo for
	it.

2005-11-27  Chris Toshok  <toshok@ximian.com>

	* HttpApplication.cs (InitOnce): add Configuration_2.0 code.
	(GetHandler): same.

2005-11-26  Miguel de Icaza  <miguel@novell.com>

	* HttpResponseStream.cs: Do not try to write zero bytes.

2005-11-24  Miguel de Icaza  <miguel@novell.com>

	* WebROCollection.cs: Do not add an empty "=" to the query string
	if the key is empty or null.

2005-11-21 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* WebROCollection.cs: override ToString and generate a query string from
	the key/value pairs. Fixes bug #76779.

2005-11-21 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpServerUtility.cs: prevent possible nullref in GetLastError().

2005-11-07  Jason Diamond  <jason@diamond.name>

	* HttpRequest.cs: Don't throw exception when Content-Length doesn't
	match length of POSTed data. Also, allow charset parameter on
	Content-Type header when type is "application/x-www-form-urlencoded".

2005-11-07 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* WebROCollection.cs: add an ID for the collection. Page needs it.

2005-11-03 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: no need to allocate the buffer when all the content
	is preloaded.

2005-11-02 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: ignore TAE in ProcesssError. The Error event might
	redirect or transfer and that causes a TAE to be thrown. Fixes
	bug #76573.

2005-11-01  Chris Toshok  <toshok@ximian.com>

	* VirtualPathUtility.cs: new (partial implementation) to get some
	MS provider examples compiling.

2005-10-31 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpContext.cs: added a new internal overload for ClearError.

2005-10-24 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRuntime.cs: invoke callbacks on private items in the cache before 
	calling disposing the app. factory. This way we get notifications of
	removal for all sessions stored in the cache (InProc only).

2005-10-19 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponseStream.cs: reworked buffering so that adjacents blocks are
	written at once. Also fix bug #76460.

2005-10-18 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponseStream.cs: when allocating a chunk larger than the
	default chunk size, mark all the blocks as taken. Fixes bug
	#76452.

2005-10-17 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: use HaveFilter instead of Filter.
	* HttpResponseStream.cs: allocate chunks of the requested size
	when it's > 32KB. Fixes bug #76460.

2005-10-14  Sebastien Pouliot  <sebastien@ximian.com> 

	* ServerVariablesCollection.cs: Added a demand for 
	SerializationFormatter on GetObjectData method (even if it's not 
	really required in this case as it remove warnings from gendarme.

2005-10-07 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs:
	* HttpRequest.cs: buglets in error checking in Filter.

2005-10-03 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* OutputFilterStream.cs: proxy class for response filters.
	* HttpResponse.cs: moved all the actual write operations into the
	response stream. Handle response filtering. When caching, get the
	actual length of the data, not the buffer length.
	* HttpApplication.cs: if there's no error, invoke the filters before
	updating the request cache.
	* HttpResponseStream.cs: new Filter property. SendChunkSize is moved
	here and now supports writing the final chunk. New method ApplyFilter
	that filters the existing buckets and replaces them with the filtered
	ones. Modified Write to deal with buffering and filtering.

2005-10-03 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponseStream.cs: allow for writes of more than 32K at once.

2005-10-03 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* InputFilterStream.cs proxy stream for use by filters.
	* HttpRequest.cs: implement input filtering.

2005-10-02 Eyal Alaluf <eyala@mainsoft.com>
	* HttpApplication.jvm.cs - Workaround for use of yield in
	HttpApplication.cs HttpRuntime.cs: AppDomain.Unload is not supported
	* under TARGET_J2EE

2005-09-30 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponseStream.cs: remove dead code.

2005-09-29  Sebastien Pouliot  <sebastien@ximian.com> 

	* HttpClientCertificate.cs: Remove last TODO on IsValid. This now 
	works when using XSP. Now use flags to determine valid/presence.

2005-09-26  Chris Toshok  <toshok@ximian.com>

	* HttpApplicationFactory.cs (OnAppFileChanged): add null checks
	for bin_watcher and app_file_watcher so we don't get NRE's here.

2005-09-23 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* BrowserCapabilities.cs: don't rely on the win32 attribute to be there.
	Just use the platform to determine whether Win32 is true or not. Fixes
	bug #74777.

2005-09-23 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: fixed typo when setting UI culture. Closes bug
	#76189.

2005-09-22 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: new SetFilePath() that does not conflict with
	SetCurrentExePath. Now when transfering from a page to another,
	CurrentExecutionFilePath and FilePath are correct.

2005-09-21 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* TraceContext.cs: add new method to store size of controls.
	* TraceData.cs: render control size.
	* HttpResponse.cs: new internal method to get the number of bytes of
	buffered output.
	* HttpResponseStream.cs: added Length property to the Buckets and new
	GetTotalLength.

2005-09-20 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* TraceData.cs: we have to change the method of getting a control render
	size. MS does not do this or otherwise would run into the same bug
	(#76051) that this patch fixes. This is temporarily setting the size
	to 0.

2005-09-20 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponseStream.cs: implemented Send(stream) for files. Fixes bug
	#76145.

2005-09-19 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRuntime.cs: catch errors when compiling global.asax and
	initializing the application. Fixes bug #76090.

2005-09-14  Sebastien Pouliot  <sebastien@ximian.com> 
 
	* BrowserCapabilities.cs: Fixed changes (in 2.0) with versions. Fixed
	compare with "True" (culture and case sensitivity).
	* HttpApplicationState.cs: Added LinkDemand for Minimal. Use the 
	internal HttpStaticObjectsCollection ctor to avoid the UnmanagedCode
	demand.
	* HttpContext.cs: Added LinkDemand for Minimal. Added 2.0 properties
	and methods to test CAS on them.
	* HttpRequest.cs: Added LinkDemand for Minimal. Ensure we return 
	proper values when worker_request is null.
	* HttpResponse.cs: Added LinkDemand for Minimal. Ensure we return 
	proper values when context or WorkerRequest is null. Added 2.0 
	properties and methods to test CAS on them.
	* HttpRuntime.cs: Added LinkDemand for Minimal. Added PathDiscovery 
	demands for properties returning directories. Added demand for High 
	level on AppDomainAppId and AppDomainId properties, Low level on 
	IsOnUNCShare, Medium level on ProcessRequest and a demand for 
	UnmanagedCode on UnloadAppDomain method. Constructor also has a 
	UnmanagedCode demand for 1.x.
	* HttpStaticObjectsCollection.cs: Added LinkDemand for Minimal. Added
	a UnmanagedCode demand to public ctor. Added internal ctor without the
	demand. Changed Serialize and Deserialize methods to public for 2.0.

2005-09-14  Sebastien Pouliot  <sebastien@ximian.com>

	* HttpWorkerRequest.cs: Removed TODO for 2.0 APIs and return the 
	default values for them.

2005-09-13  Sebastien Pouliot  <sebastien@ximian.com>

	* HttpApplication.cs: : Added LinkDemand and InheritanceDemand (class)
	for Minimal. Changed AssemblyLocation to a property (so it doesn't 
	require special permission, PathDiscovery) to create an instance. 
	Protected Modules property with a Demand for High level. Added some 
	missing HttpException for null context.
	* HttpServerUtility.cs: Added LinkDemand for Minimal. Added demands 
	for UnmanagedCode on all CreateObject* methods. Added demand for 
	Medium level on MachineName and ScriptTimeout properties. Added new
	overloaded Transfer method (2.0) to test CAS on it.
	* HttpUtility.cs: Added LinkDemand for Minimal. Added [Obsolete] to 
	ctor (2.0). Changed some return values when 'count' is 0. Added 
	ParseQueryString (overload) methods for 2.0 (to enabled CAS testing on
	them).
	* HttpWorkerRequest.cs: Added LinkDemand and InheritanceDemand (class)
	for Minimal. Added RequestTraceIdentifier and RootWebConfigPath (2.0) 
	properties, GetPreloadedEntityBody, GetPreloadedEntityBodyLength, 
	GetTotalEntityBodyLength and ReadEntityBody (2.0) methods to test CAS 
	on them. Fixed SendResponseFromMemory to ignore IntPtr.Zero (used in 
	tests without failures).
	* ServerVariablesCollection.cs: Fixed loadServerVariablesCollection 
	when HttpWorkerRequest is null.
	* TraceContext.cs: Added LinkDemand for Minimal. Fixed default Mode 
	(SortByTime). Added new (2.0) TraceFinished event to test CAS on it.

2005-09-13  Sebastien Pouliot  <sebastien@ximian.com> 
 
	* HttpBrowserCapabilities.cs: Added LinkDemand and InheritanceDemand 
	(class) for Minimal. Note that current MCS has problem compiling 
	security attributes on partial class (bug #75969).
	* HttpCachePolicy.cs: Added LinkDemand for Minimal. Added 2.0 methods
	(stub) to enable CAS tests on them.
	* HttpCacheVaryByHeaders.cs: Added LinkDemand for Minimal.
	* HttpCacheVaryByParams.cs: Added LinkDemand for Minimal.
	* HttpClientCertificate.cs: Added LinkDemand and InheritanceDemand 
	(class) for Minimal.
	* HttpCookie.cs: Added LinkDemand for Minimal.
	* HttpCookieCollection.cs: Added LinkDemand for Minimal.
	* HttpFileCollection.cs: Added LinkDemand for Minimal.
	* HttpModuleCollection.cs: Added LinkDemand for Minimal.
	* HttpPostedFile.cs: Added LinkDemand for Minimal.
	* HttpRequestPriority.cs: Fix enum values.
	* HttpWriter.cs: Added LinkDemand for Minimal.

2005-09-13  Sebastien Pouliot  <sebastien@ximian.com>

	* ProcessInfo.cs: Added LinkDemand and InheritanceDemand (class) for
	Minimal.
	* ProcessModelInfo.cs: Added LinkDemand and InheritanceDemand (class)
	for Minimal. Methods GetCurrentProcessInfo and GetHistory are also
	protected by Demand for High level.

2005-09-13  Sebastien Pouliot  <sebastien@ximian.com> 
 
	* HttpCompileException.cs: Added new public ctors and [Serializable]
	to 2.0. Added new Message property and GetObjectData (protected by a
	demand for SerializationFormatter) for 2.0. Fixed line-ending.
	* HttpException.cs: Added LinkDemand and InheritanceDemand (class) for
	Minimal. Renamed parameters to match documentation.
	* HttpParseException.cs: Added LinkDemand (class) for Minimal. Added
	demand for SerializationFormatter on GetObjectData method. Fixed 
	line-ending.
	* HttpRequestValidationException.cs: Added new public ctors and 
	[Serializable] to 2.0. Added LinkDemand for Minimal.
	* HttpUnhandledException.cs: Added new public ctors and [Serializable]
	to 2.0. Removed unused internal ctor. Added LinkDemand for Minimal.
	Fixed line-ending.

2005-09-13  Sebastien Pouliot  <sebastien@ximian.com>

	* HttpResponseSubstitutionCallback.cs: New. 2.0 delegate.
	* TraceContextEventArgs.cs: New. 2.0 class.
	* TraceContextEventHandler.cs: New. 2.0 delegate.

2005-09-13 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: use GetServerName instead of GetLocalAddress when
	building the Url.

2005-09-09 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: fix the indexer.

2005-09-08 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpPostedFile.cs: fixes in Seek and Position.

2005-09-08  Sebastien Pouliot  <sebastien@ximian.com>

	* HttpRequest.cs: Make sure the MemoryStream created have their 
	contents marked as public - or else you can't call GetBuffer on them!

2005-09-08  Miguel de Icaza  <miguel@novell.com>

	* HttpRequest.cs: Patch from Juraj Skripsky <js@hotfeet.ch> that
	fixes UrlReferrer. 

2005-09-08 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpPostedFile.cs: Make this class actually work. Every time we read,
	we have to position the underlying stream.

2005-09-08 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: reading multipart/form-data works again.

2005-09-08 Eyal Alaluf <eyala@mainsoft.com>
	* HttpRequest.cs: Under TARGET_JVM the input stream must allow GetBuffer.

2005-09-08 Eyal Alaluf <eyala@mainsoft.com>
	* HttpApplicationFactory.cs: TARGET_J2EE/JVM fix.

2005-09-07 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: correctly detect multipart/form-data.

2005-09-07 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs: recycle after invoking session_end.

2005-09-06 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRuntime.cs: remove Console.

	* HttpApplicationFactory.cs: don't hook Session_End, but keep
	the MethodInfo around for later invocation if needed. Don't call
	GetMethods() for every HttpApplication (or derived class) instances.
	Added a method, used by SessionStateModule, that will create use an
	application without context to invoke Session_End. Keep a pool of
	applications that are meant to be used by this method only.

	* HttpApplication.cs: add a SetSession method and do not
	attach all the events if the application is for Session_End only.

2005-09-06 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRuntime.cs: actually unload the domain when requested. Reformatted
	FinishUnavailable() and removed the 'Location' header form the error.

	* HttpApplicationFactory.cs: set up the watcher for the bin directory.
	This also prevents a nullref when global.asax is changed.

2005-09-06 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: fixed bug introduced when moving GetHandler call
	around. Now we get error pages again.

2005-09-06  Miguel de Icaza  <miguel@novell.com>

	* HttpApplication.cs: Catch EndRequest errors as well.

2005-09-05  Miguel de Icaza  <miguel@novell.com>

	* HttpApplication.cs: Invoke EndRequest handler before OutputPage
	as FormsAuthentication will issue a Redirect from the EndRequest 
	handler. 

2005-09-05 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: when writing an error message, catch the possible
	write error.

2005-09-05 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponseStream.cs: prevent invalid cast exception if the first
	thing written is a file.

2005-09-04 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: fix invalid cast exception (bug #75926).

2005-09-01 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs: only trigger the Application_Start event
	once. It was being invoked more than once when several clients were
	hitting the server at the same time on startup.

2005-09-01 Eyal Alaluf <eyala@mainsoft.com>

	* HttpContext.cs HttpResponse.cs HttpWorkerRequest.cs HttpRuntime.cs
	  HttpApplicationFactory.cs HttpApplication.cs: TARGET_J2EE/JVM fixes.
	  Mostly workaround limited AppModel in TARGET_J2EE.

2005-08-31 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: if the request method is HEAD, that's equivalent to
	SuppressContent. Added an internal TransmitFile that allows setting the
	final_flush flag.
	* StaticFileHandler.cs: use the new internal TransmitFile and remove
	generation of Content-Length header, as now it's computed correctly.
	* HttpApplication.cs: remove debugging stuff.
	* HttpResponseStream.cs: suppress_content is checked in HttpResponse.

2005-08-31  Miguel de Icaza  <miguel@novell.com>

	Removed debugging info.
	
	* HttpApplication.cs: Add support for async handlers. 

	Add extra 2.x methods. 

2005-08-31 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* BrowserCapabilities.cs: removed extra 'using'.

	* HttpApplication.cs: use just the 'modcoll' to hold the collection of
	modules instead of having a separate 'modules' one.

2005-08-30 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: clone the module collection so that
	it's not shared between HttpApplications. Call GetHandler() in the
	right place.

2005-08-30  Miguel de Icaza  <miguel@novell.com>

	* HttpApplication.cs: Add the new 2.x method overloads that take a
	data object.

	(RunHooks): Pass the extra data instead of null.

	* HttpCookie.cs (HttpOnly): Add 2.x cookie header.

	* BrowserCapabilities.cs: Move the core of the capabilities into a
	separate file.  Use partial classes to choose what version to
	compile against.

	* HttpBrowserCapabilities.cs: Update to move the code elsewhere.

2005-08-30 Eyal Alaluf <eyala@mainsoft.com>

	* HttpResponseStream.cs: Fix a bug introduced by last fix (thanks to
	Ben)

2005-08-30 Eyal Alaluf <eyala@mainsoft.com>

	* HttpResponseStream.cs: Compilation fixes for TARGET_JVM. TARGET_JVM
	does not support unsafe code. I localized all unsafe code within Chunk
	& Block and created a managed version of Chunk.

2005-08-30 Eyal Alaluf <eyala@mainsoft.com>
	* HttpApplicationFactory.cs: Compilation fixes for TARGET_J2EE. Under
	TARGET_J2EE static fields are shared by all app domains. We handle
	this difference by explicitly getting/setting values from the app
	domain.  Since HttpApplicationFactory has many static fields, I
	refactored it to have one static instance and moved the static fields
	into instance fields.

2005-08-29 Eyal Alaluf <eyala@mainsoft.com>

	* HttpRequest.cs: Disable use of IntPtrStream for TARGET_JVM

2005-08-29 Eyal Alaluf <eyala@mainsoft.com>

	* HttpContext.cs: Compilation fixes for TARGET_J2EE/JVM

2005-08-28 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: don't duplicate the 'charset=' and don't send a
	charset for unknown MIME types.
	* StaticFileHandler.cs: set the Content-Length header here.
	* HttpRequest.cs: prevent nullrefs when we have no 'charset='.

2005-08-28 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* StaticFileHandler.cs: use TransmitFile instead of WriteFile. This way
	xsp will use sendfile().

2005-08-28  Chris Toshok  <toshok@ximian.com>

	* SiteMapNode.cs: fix IHierarchyData.GetParent.

2005-08-26 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs:
	* IntPtrStream.cs: now we only have a read-only MemoryStream or an
	IntPtrStream. The copy is moved into HttpRequest.

2005-08-26  Sebastien Pouliot  <sebastien@ximian.com>

	* WebCategoryAttribute.cs: New. Required internal attribute.
	* WebSysDescriptionAttribute.cs: New. Required internal attribute.

2005-08-26  Jackson Harper  <jackson@ximian.com>

	* HttpResponseStream.cs: Use GetBuffer so the memory isn't
	duplicated.

2005-08-26 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: GetHandler might return null when, for example,
	a web service fails, but that does not mean that returning a null
	handler should throw another exception, as the web service code
	serialized the error as a faultString. So if the handler is null, just
	don't call ProcessRequest and keep going.

2005-08-26  Jackson Harper  <jackson@ximian.com>

	* HttpResponse.cs: Send the cached headers if this is a cached
	response. Save the headers, date header, and page data. Fix a typo.
	* HttpResponseStream.cs: Add new accesor to get a byte [] of the
	page data.

2005-08-26 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpWorkerRequest.cs: SetEndOfSendNotification is a noop. No matter
	what callback you use that never gets called. In XSP I actually
	implement something for this method.
	* HttpServerUtility.cs: unused variable.

2005-08-26 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpInputStream.cs: new ctor that takes a byte [].
	* IntPtrStream.cs: make it work on a byte [] too.

	* HttpRequest.cs:
	(ContentLength): return 0 for negative numbers or error parsing, but
	keep content_length negative in those cases.
	(MakeInputStream): when there's no content-length (or it's negative),
	we still read the request into a MemoryStream. Use
	IsEntireEntityIsPreloaded() as a fast path.

2005-08-25  Sebastien Pouliot  <sebastien@ximian.com>

	* HttpClientCertificate.cs: On 1.x the .ctor throws a 
	ArgumentNullException (but 2.0 throws a NRE).

2005-08-25 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: HttpMethod deserves its own field. Fix IsLocal.

2005-08-25  Chris Toshok  <toshok@ximian.com>

	* HttpApplication.cs (IsReusable): return true.
	(InitOnce): remove the initialization of handler_factory from
	here.
	(GetHandler) and move it here, so we make sure to load handlers
	from all needed web.config files.

2005-08-25 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpServerUtility.cs: use GetHandler().
	* HttpApplication.cs: remove obsolete method. Now Transfe/Execute work.

2005-08-25 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: no need for the local var. here.

2005-08-25  Chris Toshok  <toshok@ximian.com>

	* HttpApplication.cs (InitOnce): move the initialization of
	modules above the call to HttpApplicationFactory.AttachEvents,
	since that method accesses HttpApplication.Modules.  Fixes
	nGallery.
	(IsReusable): mark TODO.

2005-08-23 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponseHeader.cs: removed obsolete class.
	* HttpResponse.cs: no more 'obsolete' warnings.

2005-08-23 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRuntime.cs: implemeted some missing properties.

2005-08-22 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: implemented RemoveOutputCacheItem().

2005-08-22 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: implemented GetVaryByCustomString().

2005-08-22 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: implemented SetHeader (allows adding a header
	circumventing the read-only protection of the collection) and SetForm,
	which just assigns a value of the 'form' collection.
	* HttpServerUtility.cs: NameValueCollection -> WebROCollection.

2005-08-22 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpContext.cs:
	* HttpRequest.cs: implemented RewritePath and supporting methods.

2005-08-22  Sebastien Pouliot  <sebastien@ximian.com>

	* HttpRequest.cs: Avoid NRE if work_request if null in the ctor.
	* HttpResponse.cs: Avoid NRE if work_request if null in the ctor.

2005-08-20 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: if there's any exception thrown when getting the
	handler, don't add an extra error to the context, as we already have
	one.

2005-08-20 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpWriter.cs:
	* HttpResponse.cs:
	* HttpWorkerRequest.cs:
	* HttpApplication.cs: added mising attributes and enabled methods
	present in 1.1 SP1.

2005-08-20 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* WebROCollection.cs: a collection that allows setting IsReadOnly.
	* HttpRequest.cs: implemented MapImageCoordinates(). Use WebROCollection
	instead of a NameValueCollection in Form, Headers, Params, QueryString.

2005-08-19 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpInputStream.cs: new copy ctor.
	* IntPtrStream.cs: getters for base_address and size.
	* HttpRequest.cs: implemented SaveAs(). Use a wrapper on top of
	InputStream so that reading POST form or files does not modify the state
	if InputStream. Don't use uri_builder.Query in QueryStringRaw, as it
	returns the '?'.

2005-08-18 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: implemented UserLanguages and reuse code from
	AcceptTypes.

2005-08-18 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: implemented AcceptTypes.

2005-08-18 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: implemented this[] in terms of Params. Don't add the
	header collection in Params.

2005-08-18 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: fix Files property.
	* HttpApplication.cs: invoke the default authentication event after all 
	the other auth. modules.

2005-08-18 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* ServerVariablesCollection.cs: mark the collection as read-only except
	when we fill it. Add the HTTP_blah key/value pairs too.

2005-08-18  Chris Toshok  <toshok@ximian.com>

	* HttpRequest.cs (get_Params): implement.

2005-08-17  Chris Toshok  <toshok@ximian.com>

	* HttpResponse.cs: HttpResponse's Cookie's collection acts
	differently than HttpRequests in that it never returns null from
	the "this [string]" accessor.

2005-08-17 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: check length 0 case when reading a POST.

2005-08-17 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpContext.cs: added security attributes for User and
	SkipAuthorization properties.
	* HttpApplicationFactory.cs: AttachEvents is now called form the
	application .ctor. Recycle instead of dispose.
	* HttpApplication.cs: attach events to the newly created application.

2005-08-15  Jackson Harper  <jackson@ximian.com>

	* ApplicationShutdownReason.cs: make build

2005-08-15  Miguel de Icaza  <miguel@novell.com>

	* HttpApplication.cs: Update comments

	* HttpPostedFile.cs: Use a substream to read from the uploaded
	multiparts. 

	* HttpRequest.cs: use new code to read the uploaded files.

2005-08-12  Miguel de Icaza  <miguel@novell.com>

	2.x API fixage and small additions:
	
	* HttpResponse.cs: Make constructor internal.

	* HttpRequest.cs (IsLocal): Expose if NET_2.x

	* HttpContext.cs: Remove internal routine.

	* HttpApplication.cs: Add 2.x events. 

	* HttpRequest.cs: Another iFolder issue: I was not setting up the
	uri_builder here.

	Fixes to get iFolder to work:
	
	* HttpApplicationFactory.cs: Set the context when we are initting
	the application.

	* HttpApplication.cs (SetContext): helper routine. 

	* HttpResponse.cs: Implement the various cache operations:n
	Expires, ExpiresAbsolute, CacheControl.

	Actually produce the Cache-Control header, the "Cache" property
	takes precedence over the compatibility settings (Expires,
	ExpiresAbsolutely and CacheControl). 

	* HttpCachePolicy.cs: Fix style.

	Fix the generation of the headers, use lower-case values, do not
	add the max-value if the value is zero.  

	Allow for all possible values in SetCacheability. 

	* HttpRuntime.cs (ClrInstallDirectory): Implement.

	* HttpResponseStream.cs: Remove debugging stuff. 

2005-08-11  Miguel de Icaza  <miguel@novell.com>

	Big chunked handling rewrite, and integration of Ben's unmanaged
	output stream.

	* HttpWriter.cs: Delegate chunked encoding writing to the
	HttpResponse. 

	* HttpResponse.cs: Rework the chunked encoding system, centralize
	it all. 

	* HttpResponseStream.cs: Deploy Ben's bucket-base unmanaged
	buffers code. 

	Changed the way that we handle chunked encoding, centralize it
	all;  

	Remove a lot of manual handling of buffering turned off, and
	instead delegate it all to Flush, fixes several issues with the
	new framework.

	* HttpWorkerRequest.cs (SendResponseFromMemory (IntPtr, int)):
	Provide a default implementation since currently XSP does not have
	this method implemented. 

2005-08-11  Sebastien Pouliot  <sebastien@ximian.com> 
 
	* HttpClientCertificate.cs: Culture insensitive int parsing. Fixed
	NET_2_0 build.

2005-08-10  Miguel de Icaza  <miguel@novell.com>

	* ServerVariablesCollection.cs: For Ben.  Implement the header
	fetching here, do not implement it in HttpRequest.cs.

2005-08-10  Sebastien Pouliot  <sebastien@ximian.com> 
 
	* HttpClientCertificate.cs: Changed IsPresent logic so that new unit
	tests will work as expected.

2005-08-10  Sebastien Pouliot  <sebastien@ximian.com>

	* HttpClientCertificate.cs: Implemented, except for validation. Note 
	that the HttpWorkerRequest derived classes must be updated to supply 
	the required informations.
	* HttpRequest.cs: Create an HttpClientCertificate on first call to
	ClientCertificate.

2005-08-09  Miguel de Icaza  <miguel@novell.com>

	* HttpRuntime.cs (AspInstallDirectory): Implement.

2005-08-09  Sebastien Pouliot  <sebastien@ximian.com>

	* HttpClientCertificate.cs: New. Stub. It won't be fun to test.

2005-08-04  Ben Maurer  <bmaurer@ximian.com>

	* HttpContext.cs: Kill a NIE.

2005-08-04  Miguel de Icaza  <miguel@novell.com>

	* HttpApplicationFactory.cs: Change "Start" event like the "End"
	event, and only do this once, when we init the type.

	Fire the "Application_Start" event after we create the type.

2005-08-03 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: catch a ThreadAbort (coming from Response.End)
	here too.

2005-08-03 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: setting the Status property resets the
	StatusDescription (see the tests) and the default value for the
	description is the one provided by GetStatusDescription() in
	HttpWorkerRequest.

2005-08-03 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: s/boundry/boundary/ and fix typo in array creation.

2005-08-03 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: add call to EndOfRequest when everything is said
	and done.

2005-08-02  Miguel de Icaza  <miguel@novell.com>

	* HttpResponse.cs: Stub for TransmitFile.

	* HttpRequest.cs (IsAuthenticated): Implement.

2005-08-01  Miguel de Icaza  <miguel@novell.com>

	* HttpRequest.cs: Cope with implementations of HttpWorkerRequest
	(unpatched xsp) that do not send back the PreloadedEntityBody. 

	* HttpApplication.cs: keep track of the factory. 
	(Dispose): Only dispose once, clean up other variables, release
	the ManualResetEvent.
	Release the handler to the factory.

	* HttpApplicationFactory.cs: Implement a stack to reuse the
	applications. 

	* HttpRequest.cs: On uploads, if the ContentLenght is zero, throw
	a 411.

	* HttpRuntime.cs: Recycle the application after using it.

	* HttpPostedFile.cs: Implement SaveAs.

	* HttpContext.cs: Return the "Server" property.

2005-08-01 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpServerUtility.cs: implemented missing bits.

2005-08-01 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: query string was getting a '?' as the start of the
	first variable name. This makes the asmx help page work again.

2005-08-01  Miguel de Icaza  <miguel@novell.com>

	* HttpRequest.cs (Cookies, Forms): Add validation.
	(Forms): Add application/x-www-form-urlencoded parsing and
	multipart/form-data parsing.
	
	(HttpMultiPart): Implement new class to load multi-part data from
	a stream since there is no longer a byte [] that holds the data
	(currently we have an unmanaged IntPtr buffer wrapped as a
	stream).  Also the 2.x framework will add support for large
	uploads which are sent directly to disk, which will require the
	FileStream interface. 
	
	(Path, PathInfo): Fill a couple more methods to avoid crashes.

	* HttpContext.cs: Fill another one to get web services summary
	page painting.  The page does not work though.
	
	* HttpApplication.cs: Rework the pipeline to not depend on
	`finally', as `finally' would not be invoked if we choose not to
	call the pipeline again (which happens if the `stop' variable is
	set). 

	Instead force the pipeline to go to the shutdown, and yield from
	there after all the release-state callbacks have been invoked. 

2005-07-31  Miguel de Icaza  <miguel@novell.com>

	* HttpApplication.cs: Remove debugging messages since the compiler
	bug has been fixed.

	You must use at least mcs from revision 47879 for the application
	pipeline to work. 

2005-07-30  Miguel de Icaza  <miguel@novell.com>

	* HttpContext.cs: Error handling methods.

	* HttpResponse.cs: Trigger the last event.

	* HttpRuntime.cs: Add queueing of the next request. 

	* HttpApplication.cs: Deploy the new yield-based application
	pipeline, add error handling to the pipeline.
	
	* HttpApplication.cs (AsyncRequestState): Just use the done event
	from the parent.

2005-07-29  Miguel de Icaza  <miguel@novell.com>

	* HttpResponseStream.cs, HttpRequest.cs: Fix bugs found by nunit.

	* HttpApplication.cs: Fix a race condition. 

	* HttpResponseStream.cs: Fix bug, send the size of the buffer that
	we have so far instead of the internal size of the buffer.   This
	will need work later to ensure we enforce the Content-Length
	maximum output size if set.

	* ServerVariablesCollection.cs: This class now inherits from
	NameValueCollection, we should probably review what the middle
	class did, there are no dependencies on it.

	I need to write tests to investigate if something is missing or
	has changed in this implementation. 

2005-07-27  Miguel de Icaza  <miguel@novell.com>

	* HttpRequest.cs: No happy replies here, send a 411.

2005-07-27  Chris Toshok  <toshok@ximian.com>

	* HttpResponseHeader.cs: remove spew.
	
2005-07-27  Chris Toshok  <toshok@ximian.com>

	* HttpResponseHeader.cs (HttpResponseHandler..ctor): use
	HttpWorkerRequest.GetKnownResponseHeaderName instead of
	GetKnownRequestHeaderName.  Fixes Response.Redirect until miguel's
	new HttpReponse is online.

2005-07-26  Miguel de Icaza  <miguel@novell.com>

	* HttpResponse.cs: use_chunked is now a byte-array, if not null,
	we use it to hold the size of the chunked so we do not have to
	allocate many of these. 
	(SendSize): Helper routine to send the chunked headers.
	(BinaryWrite): First user of the chunked writer.

	* HttpApplication.cs: Do not crash if they request a Server
	instance, but throw a NotImplementedException.

	* HttpRequest.cs: fix a few problems exposed by the regression
	test suite.

	* HttpRequest.cs (Cookies): use Chris' new constructor to get the
	cookies parsed.

	: The big Uri rework: instead of using QueryString
	as the population mechanism, populate an UriBuilder from the
	various HttpWorkerRequest methods.

	* HttpWorkerRequest.cs (GetProtocol): Implement in terms of
	IsSecure().

	* HttpResponse.cs: Pointed by Ben, Write (null) is a nop instead
	of a crash.

	* HttpContext.cs: Add a couple of properties to help the 2.x
	build.
	
	* HttpResponse.cs: Make ContentLength a long, add back support for
	session's app_path_mod.
	(ApplyAppPathmodifier): put back.
	(End): Pass a flag to abort so we can tell the exceptions appart
	in HttpApplication.
	(WriteHeaders): Send the HTTP status.
	(Redirect): Implement.
	(Write): Use the Output property to load writer when needed.
	
	* HttpRequest.cs (ctor): Temporary use of InitFromWR, will fix
	later. 
	(MakeInputStream): check content-length size, use routines to load
	the preloaded data, handle incomplete transfers.
	(Query): Do not insert null keys into the collection.
	(Url): implement.
	(UrlReferer): implement.

	* HttpApplication.cs (RunHooks): Catch Thread.Abort, and call
	Thread.ResetAbort after each step.

	Ensure that ReleaseState is called if we ever succeed in acquiring
	the state even if we have stopped the request pipeline.

	Report file not found, directory not found.

2005-07-25  Miguel de Icaza  <miguel@novell.com>

	* HttpCookieCollection.cs: Add expiration of the cookie. 

	* HttpRequest.cs: Add check for ContentLength, use
	GetPreloadedEntityBody, correct number of bytes uploaded.

2005-07-21  Miguel de Icaza  <miguel@novell.com>

	* HttpResponseHeader.cs: Our implementation of HttpResponse only
	uses the text headers, does not use any constants as XSP would go
	through a slower code path anyways.

2005-07-21  Chris Toshok  <toshok@ximian.com>

	* HttpBrowserCapabilities.cs: enable support for the W3CDomVersion
	and EcmaScriptVersion properties.

2005-07-21  Chris Toshok  <toshok@ximian.com>

	* HttpResponseHeader.cs: hi, i'm stupid and missed String.Replace.
	
2005-07-21  Chris Toshok  <toshok@ximian.com>

	* HttpResponseHeader.cs: url encode just \r and \n if they're
	present in the value.

2005-07-20  Chris Toshok  <toshok@ximian.com>

	* HttpPostedFile.cs: add missing ContentLength property.

2005-07-20  Chris Toshok  <toshok@ximian.com>

	* HttpCookieCollection.cs: add a new ctor that takes a string (the
	contents of the Cookies: header).

2005-07-20  Chris Toshok  <toshok@ximian.com>

	* HttpCookieCollection.cs: add another ctor (internal, but not
	obsolete, so we aren't passing a stupid HttpResponse in in order
	to change the behavior of the collection.)

	* HttpCookie.cs: init this.values in the internal ctor.

2005-07-20  Chris Toshok  <toshok@ximian.com>

	* HttpCookieCollection.cs: use "auto-fill mode" when we're dealing
	with an HttpResponse's cookie collection.  That is, create the
	cookie if the consumer looks it up.

2005-07-20  Miguel de Icaza  <miguel@novell.com>

	* HttpApplication.cs: Ongoing work on pipeline, I will need to
	redo this later.

2005-07-19  Miguel de Icaza  <miguel@novell.com>

	* HttpContext.cs (GetService): Implement.  Return all of the
	properties that we have access to.  Make HttpWorkerRequest the
	first match as this is the only likely reason people need to use
	this. 

	* IntPtrStream.cs: Bring from corlib.

	* MultiPartContentParser.cs: use a MemoryStream as HttpInputStream
	will now be using IntPtrStream. 

	* HttpRequest.cs (MakeInputStream): move code that loads the
	request here
	(CloseInputStream): Helper method that we will call later to
	ensure that we dispose properly the malloced() block. 
	(BinaryRead): Implemented.

	* HttpInputStream.cs: Rewrite to be a descendant of
	IntPtrStream.cs 

2005-07-18  Miguel de Icaza  <miguel@novell.com>

	* HttpApplication.cs (Modules): Add modules support and
	AsyncResult.

2005-07-18  Chris Toshok  <toshok@ximian.com>

	* HttpResponseHeader.cs: initial implementation.

2005-07-18  Chris Toshok  <toshok@ximian.com>

	* HttpModuleCollection.cs (HttpModuleCollection.GetKey): add
	missing method.

	* HttpFileCollection.cs: initial implementation.

2005-07-18  Chris Toshok  <toshok@ximian.com>

	* HttpModuleCollection.cs (HttpModuleCollection.CopyTo): implement
	missing method.

2005-07-18  Chris Toshok  <toshok@ximian.com>

	* HttpModuleCollection.cs: initial implementation.

2005-07-18  Chris Toshok  <toshok@ximian.com>

	* HttpCacheVaryByHeaders.cs: only add the header if it's not
	already in the hash.

	* HttpCacheVaryByParams.cs: only add the param if it's not already
	in the hash.

2005-07-18  Chris Toshok  <toshok@ximian.com>

	* HttpCookie.cs (HttpCookie+CookieNVC.Set): new override to fix an
	MS quirk.

2005-07-17  Miguel de Icaza  <miguel@novell.com>

	* HttpRequest.cs (Headers, InputStream): implemented two more
	properties.

	* HttpInputStream.cs: All we need is a MemoryStream with writable
	set to false.

	* HttpPostedFile.cs: Use a Stream.

2005-07-16  Chris Toshok  <toshok@ximian.com>

	* HttpCacheVaryByHeaders.cs: make sure we set vary_by_unspecified
	= false in the custom setter.

2005-07-16  Chris Toshok  <toshok@ximian.com>

	* HttpCacheVaryByParams.cs: initial implementation.

2005-07-16  Chris Toshok  <toshok@ximian.com>

	* HttpCacheVaryByHeaders.cs: initial implementation.

2005-07-15  Chris Toshok  <toshok@ximian.com>

	* HttpCookie.cs: one more time.

2005-07-15  Chris Toshok  <toshok@ximian.com>

	* HttpCookie.cs (HttpCookie.GetCookieHeader): use
	expires.ToString().
	
2005-07-15  Chris Toshok  <toshok@ximian.com>

	* HttpCookie.cs (HttpCookie.GetCookieHeader): implement to fix
	ben's bug.

2005-07-15  Chris Toshok  <toshok@ximian.com>

	* HttpCookieCollection.cs: initial implementation (with a couple
	of labeled inefficiencies.)

2005-07-15  Chris Toshok  <toshok@ximian.com>

	* HttpCookie.cs (HttpCookie.get_HasKeys): use values.HasKeys()
	instead of trying to be smart about it ourselves.

2005-07-15  Chris Toshok  <toshok@ximian.com>

	* HttpCookie.cs: initial implementation.  we fail one unit test,
	but it might be due to a bug in NameValueCollection.

2005-07-15  Miguel de Icaza  <miguel@novell.com>

	* HttpRequest.cs: 

2005-07-14  Miguel de Icaza  <miguel@novell.com>

	* HttpRuntime.cs: Return a few of the values from the AppDomain
	data. 

	Put the application shutdown process.

	* HttpApplicationFactory.cs (AddEvent): Fixed bug when more than
	one method existed.
	
	(FireEvent): Do not ignore errors.

	* HttpContext.cs (GetAppConfig, GetConfig): First success, use
	ConfigurationSettings.GetConfig to get the value that QueueManager
	needed.

2005-07-14  Dick Porter  <dick@ximian.com>

	* HttpPostedFile.cs: New basic implementation; needs someone to
	figure out what a HttpRequestStream does

2005-07-13  Miguel de Icaza  <miguel@novell.com>

	* HttpRequest.cs: More work on this file

	* HttpRequest.cs, HttpApplication.cs, HttpContext.cs,
	HttpRuntime.cs: New from scratch implementation.

2005-07-01  Lluis Sanchez Gual <lluis@novell.com>

	* SiteMap.cs: Read provider info from the configuration files.

2005-06-27 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponseHeader.cs: URL encode \r and \n in header values. Fixes
	bug #75392.

2005-06-26 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpUtility.cs: fix another stupid buglet in htmldecode.

2005-06-26 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpContext.cs:
	* HttpResponse.cs:
	* HttpRequest.cs: use StrUtils (invariant culture).

2005-06-26 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: use StartsWith when looking for 'multipart/form-data'.
	File uploading was broken since a few commits ago.

2005-06-26 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: ensure that the last chunk ('0\r\n\r\n') is sent
	even if response.Close is called before a final flush. MS/IIS fails to
	do this.

2005-06-25 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: don't print anything for unknown content types in
	ParseFormData. Use lowercase compare.

2005-06-25 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: invariant love.

2005-06-25 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: avoid 1 string concat.
	* HttpRequest.cs: fix BinaryRead. It was totally wrong.

2005-06-23 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpUtility.cs: don't append an extra 0 when no digits seen. Fixes
	bug #75370.

2005-06-23 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpUtility.cs: the lower limit for using &#xx; encoding is 160, not
	128. Reset number back to 0 after use. Fixes bug #75365.

2005-06-19  Svetlana Zholkovsky <svetlanaz-at-mainsoft.com>
		* In following classes added TARGET_J2EE or/and TARGET_JVM
		  directives:
			- HttpResponse.cs
			- HttpRuntime.cs
			- HttpUtility.cs
			- CapabilitiesLoader.cs
			- HttpApplication.cs
			- HttpApplicationFactory.cs
			- HttpContext.cs
			- HttpException.cs
			- HttpRequest.cs
		* Added Mainsoft's specific files :
			- GhHttpAsyncResult.jvm.cs

2005-06-10 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: avoid one intermediate buffer when reading the request
	body and fail for over limit content length when the content type is
	not handled as form or multipart data.

2005-06-09 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: fix the check in Close() so that CloseConnection is
	called even if there has been no final Flush. Fixes bug #75176.

2005-06-08 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpParseException.cs:
	* HttpResponse.cs:
	* HttpApplication.cs: updates for 1.1 service pack.

2005-06-06 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpUtility.cs: fix InvalidCastException.

2005-06-05  Kornél Pál <kornelpal@hotmail.com>

	* HttpWriter.cs: Fixed: _OutputFilter.Close () was called twice.

2005-06-02 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpUtility.cs: modified HtmlDecode so that it does not need to call
	Int32.Parse and handles improper &# sequences. Fixes bug #74907.

2005-05-26  Lluis Sanchez Gual <lluis@novell.com>

	* SiteMapNodeCollection.cs: Implemented missing methods. The collection
	does not inherit from CollectionBase any more.
	* SiteMapNode.cs: Track api changes.
	* SiteMapProvider.cs: Moved several methods to the new
	StaticSiteMapProvider class. Other fixes.
	* XmlSiteMapProvider.cs: Watch changes in the xml files. Other fixes.
	* SiteMapProviderCollection.cs: Minor fixes.
	* SiteMap.cs: Added missing event. Avoid double check lock.
	* StaticSiteMapProvider.cs: New class that implements some of the
	funtionality of SiteMapProvider.

2005-05-25  Ben Maurer  <bmaurer@ximian.com>

	* MimeTypes.cs: Remove extra spaces, they were typos. Fixes 75049.

2005-05-13 Atsushi Enomoto <atsishi@ximian.com>

	* HttpUtility.cs : UrlDecodeToBytes() incorrectly decoded escaped 
	  characters. Patch by Kazuki Oikawa.

2005-05-09 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRuntime.cs: PlatformID.Unix.

2005-05-08 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: cleaned up the .ctors, fix IsClientConnected and just
	Clear the _Headers array instead of creating a new ArrayList in
	ClearHeaders().

2005-05-08 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: we had 2 variables to track client connection status.
	Use only one. Increase the buffer size to 28KB when writing from a file.

	* StaticFileHandler.cs: set the Content-Type before writing the file.
	This allows flushing before all the content is written.

	* HttpApplication.cs: use the variable instead of the property when
	setting the Principal for the current process.

2005-05-08 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* ReusableMemoryStream.cs:
	* HttpWriter.cs: keep a pool of buffers to avoid allocations.

2005-05-07 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: no need to save/restore the thread culture when
	getting the Date header. According to Ben's profiling, this is a big
	deal in performance.

	* HttpRuntime.cs: ignore exceptions that might be thrown when unloading 
	a domain.

2005-05-04 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs: ignore any exception thrown when invoking
	an application event.

2005-04-23 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpBrowserCapabilities.cs: fix Win32 property.

2005-04-21 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: only add the charset when explicitly set or for
	well-known content types.

2005-04-20 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpCachePolicy.cs:
	* HttpAsyncResult.cs:
	* HttpClientCertificate.cs:
	* HttpException.cs:
	* HttpRuntime.cs:
	* HttpCacheVaryByHeaders.cs:
	* HttpBrowserCapabilities.cs:
	* HttpUtility.cs:
	* HttpCacheVaryByParams.cs: no more warnings.

	* QueueManager.cs: check for local connections with minLocalFreeThreads.

2005-04-19 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* ServerVariablesCollection.cs: shuffled variables, added missing ones
	and call a method in HttpRequest to set the HTTP_ variables.

	* HttpRequest.cs: new method to add HTTP_ variables to a collection.

2005-04-19 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: GetAllHeaders was returning the value twice instead
	of 'name: value'. When HTTP_ is requested on the output, don't include
	unknown headers.

2005-03-23 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpCookieCollection.cs: when adding more than one cookie with the
	same name, the last one is the winner.

2005-03-09 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: correctly store the value cookies in Params. Fixes
	bug #73345.

2005-02-28 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: Path and FilePath also change when RewritePath is
	called. Fixes bug #73055.

2005-02-23  Sebastien Pouliot  <sebastien@ximian.com>

	* HttpRequest.cs: Make sure that any access after a ValidateInput 
	throws an exception if the data isn't safe.

2005-02-22 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* CapabilitiesLoader.cs: fix the path, as machine.config is now in a
	x.x/ directory below $PREFIX/etc/mono.

2005-02-22 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: fail on unicode full-width '<' and '>' too. Fixes
	a security report (http://secunia.com/advisories/14325) that wan't
	reported to us before public disclosure.

2005-02-18 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: send the calculated content length even when it's 0.
	Fixes bug #72655.

2005-02-04  Lluis Sanchez Gual <lluis@novell.com>

	* HttpContext.cs: Added internal property to keep a reference to
	the last accessed page. Page uses this to implement PreviousPage.

2005-02-02  Lluis Sanchez Gual <lluis@novell.com>

	* ProcessModelInfo.cs: Fixed warning.

2005-02-01 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* TraceContext.cs: writing a message without any other argument is not
	a warniing. Fixes bug #72017.

2005-01-20 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: if there are no more handlers, finish the
	request and ensure we call Complete on it. Now FreeTextBox 3.0 works.

2004-12-21 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: honor the maxRequestSize limit from machine.config.

2004-12-15 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: reread application CultureInfo as web.config
	might have changed. Fixes bug #62539.

2004-11-30 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: fixed ApplyAppPathModifier to insert the session ID.

2004-11-29 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs: monitor changes in global.asax and bin
	directory and shutdown the application when that happens. Fixes bug
	#49651.

2004-11-29 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* ReusableMemoryStream.cs: copied from System.IO.MemoryStream and
	slightly modified to allow expanding the buffer for cases on which the
	regular MemoryStream don't allow it.

	* HttpWriter.cs: use the new ReusableMemoryStream and fix bug #59841.
	Otherwise we would have to allocate a new MemoryStream...

2004-11-28 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: Create() is now GetInstance().

2004-11-18 Lluis Sanchez Gual <lluis@novell.com>

	* SiteMapNodeCollection.cs: Added missing properties.
	* HttpParseException.cs: Added 2.0 methods and properties.
	* SiteMapNode.cs: Added missing methods and properties.
	* SiteMapProvider.cs, XmlSiteMapProvider.cs, 
	SiteMapProviderCollection.cs: IProvider does not exist any
	more, it is now	ProviderBase.
	* ISiteMapProvider.cs: Deleted.
	* ParserErrorCollection.cs, ParserError.cs, SiteMapResolveEventArgs.cs:
	  Implemented.
	* SiteMap.cs: Minor fixes.	

2004-11-15 Lluis Sanchez Gual <lluis@novell.com>

	* SiteMapProviderCollection.cs: Fixed warning.
	* HttpApplication.cs: Added new 2.0 events.

2004-11-12 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: added internl SetHeadersSent.
	* HttpRuntime.cs: don't throw the 'headers already sent' exception
	if we're sending a runtime error.

2004-11-11 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: undo the TimeoutManager.(Add|Remove) shuffling.
	It causes troubles under heavy load.

2004-11-08 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* SiteMap.cs: don't lock on Type.
	* CapabilitiesLoader.cs: avoid 2 locks when loading data.

2004-11-08 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: patch by Dennis Gervalle that fixes PhysicalPath in
	presence of rewriting.

2004-10-27 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: don't hang if a sync step is aborted. Fixes the
	system.web portion of bug #68270.

2004-10-10 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* TraceContext.cs: don't cast to Page is the handler it's
	not a page.

2004-10-06 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: CurrentExecutionFilePath is the one that
	changes when Transfer or Execute are used, not FilePath.

	* HttpServerUtility.cs: moved form saving/restoring from
	Transfer to Execute, as it's needed there too. the query string is
	correctly set now. Fixes bug #67388.

	* HttpContext.cs: use SetCurrentExePath instead of SetFilePath.

2004-10-03 Ben Maurer  <bmaurer@ximian.com>

	* HttpResponse.cs: use UtcNow

2004-10-01 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: SuppressContent does not throw and clears all the
	buffered output. Fixes bug #67213.

2004-09-30 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpUtility.cs: UrlPathEncode is static. Fixes bug #67155.

2004-09-29 Ben Maurer  <bmaurer@ximian.com>

	* HttpContext.cs, TimeoutManager: Use DateTime.UtcNow.

2004-09-25 Ben Maurer  <bmaurer@ximian.com>

	* HttpApplication.cs: Make sure requests are removed from
	the timeout manager. Fixes a major leak. #66751.

2004-09-24 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs:
	* HttpRuntime.cs: implemented UnloadAppDomain and be ready for domain
	unloading.

2004-09-12 Ben Maurer  <bmaurer@ximian.com>

	* HttpContext.cs: use CallContext. It is a little bit faster.

2004-09-09 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpStaticObjectsCollection.cs: don't share static session objects
	declared in the application file across the application, but on a
	per-session basis. Fixes bug #65446.

2004-09-09 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpServerUtility.cs: in Transfer(path), don't keep form data if
	the transfer is done from inside a page that received a postback.
	Fixes bug #65613.

2004-09-08 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpValueCollection.cs: fixed signature of ToString (). Closes bug
	#65392.

2004-09-06 Ben Maurer  <bmaurer@users.sourceforge.net>

	* HttpWriter.cs (.ctor): Dont create teh StreamWriter twice
	(Clear): Don't recreate the MemoryStream and StreamWriter

2004-09-05 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: only add/remove to/from the timeout
	manager when we're in a interruptible step.

2004-09-05 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* TraceContext.cs: when IsEnabled has not been set, return the value
	from the TraceManager. Fixes bug #63469.

2004-08-31 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRuntime.cs: initialize the response writer when finishing a
	request because it cannot be queued. Under heavy load we made new
	requests be processed before the ones that might be queued. This is
	no longer the case.

	* QueueManager.cs: instead of queueing/dequeuing separately, we now
	have a single method that does everything needed to decide which one
	will be the next request processed.

2004-08-27 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRuntime.cs: removed initializations to null in .cctor. Prevent
	other requests from avoiding the lock if they are received before the
	configuration system is inited. Ensure that the queue manager is not
	null before using it (it can be null while the first request is being
	processed).

2004-08-22 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpServerUtility.cs: ensure we have a full virtual path for the
	request being executed.

2004-08-02  Duncan Mak  <duncan@ximian.com>

	* ApplicationShutdownReason.cs: Fixed typos.

	* HttpCookieMode.cs:
	* HttpDataTransferMode.cs:
	* HttpRequestPriority.cs: Added [Serializable] attribute.
	
2004-08-02  Duncan Mak  <duncan@ximian.com>

	* ApplicationShutdownReason.cs:
	* HttpCookieMode.cs:
	* HttpDataTransferMode.cs:
	* HttpRequestPriority.cs: Added 2.0 enumerations.
	
2004-07-21 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: the file not found might be a dependency.

2004-07-20 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpCookie.cs: use invariant when formatting expires date. Fixes bug
	#61690.

2004-07-07 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: don't keep the session around if we got it from
	the context. Fixes bug #61232.

2004-07-06 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpUtility.cs: fixed stupid bug in UrlDecode from bytes. Closes bug
	#61181.

2004-07-02 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* TraceContext.cs: added internal HaveTrace property whose
	value is true when the page has a Trace attribute.

2004-06-15 Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* TraceData.cs: fixed <br> output. Closes bug #60181.

2004-06-11  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpUtility.cs: check for control characters in the string to encode
	or decode and return the same string if there are none.

2004-06-11  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: change/restore the IPrincipal in their own methods
	and make them internal.

2004-06-09  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpContext.cs: reverting Pedro's patch and sending mail with test
	to mono-devel.

2004-06-09  Pedro Martnez Juli  <yoros@wanadoo.es>

	* HttpContext: User property returns its own "user" value because
	the context can walk through different Threads. When "User" property
	is changed, change "Thread.CurrentPrincipal" too.

2004-06-08  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: removed extra ^Ms and fixed style of last patch.

2004-06-08  Alon Gazit  <along@mainsoft.com>

	* HttpRequest.cs: Add a patch for HttpRequest.ServerVariables.

2004-06-07  Sebastien Pouliot  <sebastien@ximian.com>

	* HttpContext.cs: User property now get/set Thread.CurrentPrincipal.
	Fix (at least partially) #59683.

2004-06-07  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: reverting patch from Alon Gazit. Uses the above file
	that doesn't compile.

2004-06-07  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* TraceData.cs: fixes nullref in an application that relies on
	r ["Message"] not being null. Closes bug #59679.

2004-06-07  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpCachePolicy.cs: implemented SetAllowResponseInBrowserHistory.

2004-06-07  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRuntime.cs: implemented a 5 simple properties that were TODOs.

2004-06-07  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpBrowserCapabilities.cs: implemented ClrVersion and GetClrVersions.
	* HttpException.cs: removed MonoTODO.

2004-06-05  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* TraceContext.cs: don't check if HttpRuntime.TraceManager
	is enabled when writing.

2004-06-04  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: added ClientTarget internal property.

2004-06-03  Lluis Sanchez Gual <lluis@ximian.com>

	* HttpApplication.cs: Clear the http handler list after releasing the
	  handlers.

2004-06-02  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* TraceData.cs: html-encode the messages written to the trace. Fixes
	bug #59431.

2004-06-01  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpWorkerRequest.cs: the hashtables are now case-insensitive. Thanks
	to Markus Krutner.

2004-05-31  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: nullify _sRequestRootVirtualDir and baseVirtualDir
	when SetFilePath is called. This way the cached values are reset and
	get the right value in case someone (namely SessionStateModule + 
	cookieless session) changes the FilePath after the property cached its
	value. Fixes bug #59364.

2004-05-27	Patrik Torstensson <totte@hiddenpeaks.com>

	* HttpApplicationFactory.cs: Added SignalError (still todo)

2004-05-26  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: remove hardcoded "HTTP/1.0" version that kept
	chunked encoding disabled. Fixed chunked suffix and end. Send the
	'lastchunk' marked when in the final Flush even if the content length
	is 0. This makes mod-mono-server work fine with chunked encoding.
	 
	* HttpRuntime.cs: Set the _firstRequest* variables to true
	earlier. TraceContext don't take any parameter now.

	* TraceManager.cs: don't need a context. Use GetAppConfig.

2004-05-25  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: set culture/uiculture from configuration and
	restore it after each step. Fixes bug #52851.

2004-05-18  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpUtility.cs: use lower case in UrlEncode like MS does. Delay
	entities hashtable creation until it's really needed.

2004-05-18  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs: if no module matches the name found for a
	possible event, ignore it. Fixes bug #58542.

2004-05-16	Patrik Torstensson <totte@hiddenpeaks.com>

	* HttpRuntime (Init): Removed old todo
	* HttApplication : Implemented IHttpHandlerFactory recycling
	
2004-04-28	Patrik Torstensson

	* HttpApplicationState.cs: Performance, usage of ReaderWriter lock,
	removed MonoTodo

2004-04-16  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpUtility.cs: return null in HtmlDecode for null input instead of
	throwing an exception. Patch by Jan Jaros (bug #57083).

2004-04-10  Vladimir Vukicevic  <vladimir@pobox.com>

	* TimeoutManager.cs: Swap the order of initialization of contexts
	and the Timer, to avoid race condition of CheckTimeouts being called
	before contexts gets initialized.

2004-03-27  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequestStream.cs: patch from Jan Jaros that fixes bug #56080.
	Now the posted file content does not have the boundaries and headers
	included.

2004-03-25  Alon Gazit <along@mainsoft.com>

	* HttpRequest.cs: fix ValidateCookieCollection() to prevent
	InvalidCastException.

2004-03-15  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpValueCollection.cs: don't UrlDecode cookies. Fixes bug #55254.

2004-03-01  Larry Ewing  <lewing@ximian.com>

	* HttpUtility.cs: fix UrlEncodeToBytes count check.

2004-02-12  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpServerUtility.cs:
	* HttpUtility.cs: added some checks for null. Fixed UrlPathEncode (bug
	#53670).

2004-02-12  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpUtility.cs: fixed length check. Closes bug #54201.
	Thanks to Michal Moskal. Use MemoryStream instead of an ArrayList when
	decoding.

2004-02-11  Jackson Harper <jackson@ximian.com>

	* TraceData.cs: Use ToString for cookie/header/var name values so
	null is handled properly.
	
2004-02-09  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: ApplicationState is inited by the factory so,
	return that value in the property. when we use the context Session,
	cache it in the instance field.

	* HttpApplicationFactory.cs: fixed target Type for the event when
	hooking application and module events. Initialize application
	and session scope objects. Fixes non-aplication events hook up.

	* HttpStaticObjectsCollection.cs: added StaticItem and delay the
	creation of the objects until they are requested.

2004-01-28  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs: fixlet for session events hook.

2004-01-28  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs: attach all events from Type and BaseType
	at the same time. Fixes bug #53454.

2004-01-27  Jackson Harper <jackson@ximian.com>

	* HttpCachePolicy.cs: varybyparams::GetResponseHeader can return
	null now, dont hadd the header if it does.
	* HttpCacheVaryByParams.cs: Return null if there are no items.

2004-01-23  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpCachePolicy.cs: it's not public.
	* HttpRuntime.cs: wait for requests before disposing the queue.

2004-01-15  Jackson Harper <jackson@ximian.com>

	* HttpCachePolicy.cs: Fix typo causing varyby params headers to be
	created when they shouldn't be.
	
2004-01-14  Jackson Harper <jackson@ximian.com>

	* TraceData.cs: Fix some typos in the output text. Fix control
	position when adding controls recursively.
	
2004-01-14  Jackson Harper <jackson@ximian.com>

	* HttpCachePolicy.cs: Expose duration and sliding properties.
	
2004-01-14  Jackson Harper <jackson@ximian.com>

	* HttpCachePolicy.cs: Add an event that is fired when the
	cacheability is updated. The response uses this to determine
	whether or not it needs to cache itself.
	* HttpResponse.cs: When the cacheability is updated either create
	or dispose of the cached raw response based on whether or not we
	wil need it. This allows output caching to be controlled
	programatically.
	
2004-01-12  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpContext.cs: add setter for ConfigTimeout.
	* HttpException.cs: added Description property and HTML encode some
	unescaped values.

	* HttpRequest.cs: support request validation.

	* HttpRequestValidationException.cs: added message and description.

	* HttpServerUtility.cs: implemented ScriptTimeout.

2004-01-11  Jackson Harper <jackson@ximian.com>

	* TraceManager.cs: Dont crash if there is no trace config element.
	
2004-01-11  Jackson Harper <jackson@ximian.com>

	* HttpRequest.cs: Add property for determining if the request is
	local or not.
	
2004-01-10  Jackson Harper <jackson@ximian.com>

	* TraceContext.cs: Handle tracing when it is enabled in the config
	file but not on the page.
	* TraceManager.cs: Get settings from the configuration object.
	* HttpRuntime.cs: Create trace manager in the first request start
	so it can get configuration settings.
	
2004-01-10  Jackson Harper <jackson@ximian.com>

	* TraceContext.cs: Save the request path in the trace data.
	* TraceData.cs: Add RequestPath property, make some rendering
	methods internal static so the TraceHandler can use them.
	* TraceManager.cs: Expose trace data, add a method for clearing
	trace data.
	
2004-01-10  Jackson Harper <jackson@ximian.com>

	* HttpRuntime.cs: Add trace manager
	* TraceManager.cs: New class for handling trace configuration and
	storing trace data objects.
	* TraceContext.cs: Save trace data to the trace manager. Fix typo.
	
2004-01-10  Jackson Harper <jackson@ximian.com>

	* TraceData.cs: New class for storing trace data. Data is stored
	here instead of the trace context so it can be saved and accessed
	from the trace handler.
	* TraceContext.cs: Save data in the TraceData object, let the
	trace data object handle the rendering.
	
2004-01-08  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: use ContentEncoding for QueryString. Fixes bug #52577.
	Thanks to Jan Jaros (mono-bug@jerryweb.info).

	* HttpRequestValidationException.cs: fix comment.

2004-01-06  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpException.cs: default to error 500. Fixes bug #52623.

2004-01-04  Jackson Harper <jackson@ximian.com>

	* TraceContext.cs: Store and render trace info times. Also render
	cookie sizes. Remove debug code.
	
2004-01-04  Jackson Harper <jackson@ximian.com>

	* HttpResponse.cs: Set the cached response date header so it can
	be updated.
	* HttpResponseHeader.cs: Let values be set so we can update cached 
	response header values.
	
2004-01-04  Jackson Harper <jackson@ximian.com>

	* HttpResponse.cs: Implement RemoveOutputCacheItem.
	
2004-01-04  Jackson Harper <jackson@ximian.com>

	* HttpCachePolicy.cs: Add internal method to get the vary by custom string
	* HttpCacheVaryByHeaders.cs: Add internal method to get the header names.
	
2004-01-03  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRuntime.cs: implemented MachineConfigurationDirectory,

2004-1-1  Alon Gazit <along@mainsoft.com>
	* HttpWriter.cs: add check in Write() in order to prevent
	NullReferenceException.

2004-1-1  Alon Gazit <along@mainsoft.com>
	* HttpResponse.cs: implemented ExpiresAbsolute and Expires.

2003-12-18  Jackson Harper <jackson@ximian.com>

	* TraceContext.cs: Write () methods are not warnings.
	
2003-12-18  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpBrowserCapabilities.cs: added GetClrVersions ().
	* HttpCachePolicy.cs: added SetAllowResponseInBrowserHistory ().
	* HttpContext.cs: added set_Current and RewritePath (s, s, s) for 1.1.
	* HttpRequest.cs: added set_ContentType, SetPathInfo and ValidateInput.
	* HttpRequestValidationException.cs: new class for 1.1
	* HttpResponse.cs: added RedirectLocation.
	* HttpRuntime.cs: added UnloadAppDomain.
	* HttpServerUtility.cs: Execute (s, t, b) is internal for < 1.2
	* HttpUtility.cs: copied UrlPathEncode from HttpServerUtility.
	* HttpWorkerRequest.cs: added [ComVisible] and made the ctor public.

2003-12-17  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpContext.cs: implemented IsCustomErrorEnabled and
	IsDebuggingEnabled. Added internal ErrorPage property.

	* HttpRuntime.cs: on error, check if we have a custom error page enabled
	to handle it and redirect.

	* HttpResponse.cs: added RedirectCustomError (), which actually does
	the redirection to the error page.
	
2003-12-16  Jackson Harper <jackson@ximian.com>

	* TraceContext.cs: Render all the data, and the stylesheet.
	
2003-12-16  Jackson Harper <jackson@ximian.com>

	* TraceContext.cs: Add incomplete render method.
	
2003-12-16  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* CapabilitiesLoader.cs: loads browser detection and capabilities data
	from browscap.ini file by Gary J. Keith.

	* HttpBrowserCapabilities.cs: removed almost all TODOs.

	* HttpRequest.cs: fixed Browser property.

2003-12-15  Jackson Harper <jackson@ximian.com>

	* TraceContext.cs: Initial implementation of storing data.
	* HttpContext.cs: Create and expose a trace object.
	
2003-12-04  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: ThreadAbortException is ok on Redirect.
	* HttpContext.cs: added TimeoutPossible property.
	* HttpResponse.cs: throw ThreadAbortException if End () is called within
	a step in which is possible to timeout.

	Fixes bug #51703.

2003-12-04  Jackson Harper <jackson@ximian.com>

	* HttpRequest.cs: Cleanup method.
	
2003-12-04  Jackson Harper <jackson@ximian.com>

	* HttpValueCollection.cs: Allow blank value names. Posting
	<blank>=SomeValue is valid. And occurs if a radio button does
	not have its name set.
	
2003-12-03  Jackson Harper <jackson@ximian.com>

	* HttpResponse.cs: Actually apply an app path modifier in
	ApplyAppPathModifer and add a method to set the app path modifier.
	* HttpRequest.cs: Add utility method for setting a request header.
	
2003-12-02  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: handle FileNotFound and DirectoryNotFound
	exceptions when creating the handler to generate a better error page.

	* HttpException.cs: display the http_code if available.  Changed all
	\n by \r\n to make the hidden stack trace readable.
	
	* StaticFileHandler.cs: don't send the real path in th eerror.

2003-12-02  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpContext.cs: updated GetConfig and GetAppConfig to new API.
	
	* HttpResponse.cs: separate initialization of the HttpWriter, as it
	tries to read configuration settings while the config. system is not
	available (ie, before the first request).
	
	* HttpRuntime.cs: delayed queueManager and response writer
	initialization until the configuration system is working.

2003-11-26  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRuntime.cs: added request queue handling.

	* QueueManager.cs: simple request queue.
	
	* TimeoutManager.cs: added some locks to prevent the enumerator used in
	CheckTimeouts to be out of synch.

2003-11-25  Jackson Harper <jackson@ximian.com>

	* HttpStaticObjectsCollection.cs: Add methods for serialization
	and conversion to/from byte arrays.
	
2003-11-21  Jackson Harper <jackson@ximian.com>

	* HttpResponse.cs: When caching data set the content length in the
	cached repsonse so that only that amount will be written back to
	the client. Add method to write a range of binary data.
	* HttpCacheVaryByParams.cs: Add method to retrieve param names.
	
2003-11-21  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs:
	* HttpContext.cs:
	* HttpRuntime.cs: add timeout handling.
	* TimeoutManager.cs: new class that takes care of aborting threads on
	timeout.

2003-11-19  Jackson Harper <jackson@ximian.com>

	* HttpWriter.cs: Use a constant for the buffer size so the cache
	can get the buffer size. Add method to get the buffer.
	* HttpResponse.cs: Methods for getting data to cache, and setting
	vars from the cache.
	* HttpCachePolicy.cs: Expose a pages cache expire time.
	
2003-11-18  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: 
	* HttpWriter.cs: some fixes to allow closing a response stream without
	messing the rest.

2003-11-13  Jackson Harper  <jackson@ximian.com>

	* HttpCachePolicy.cs: Make sure cacheability and maxage get
	set. Add method to set Http response header data
	* HttpCacheVaryByParams.cs: Add method to create a response header.
	* HttpCacheability.cs: Add ServerAndPrivate and ServerAndNoCache.
	* HttpResponse.cs: Set cache headers.
	
2003-11-11 Ben Maurer  <bmaurer@users.sourceforge.net>

	* HttpModuleCollection.cs (GetKey): Recursion, again!

2003-11-11 Ben Maurer  <bmaurer@users.sourceforge.net>

	* HttpClientCertificate.cs (ValidUntil): recursion!

2003-11-08 Ben Maurer  <bmaurer@users.sourceforge.net>

	* SiteMapNode.cs (GetDataSourceView): Implement.
	* SiteMapProvider.cs: Typo fixing.
	* XmlSiteMapProvider.cs: We shouldnt resolve here.
	
2003-11-08 Ben Maurer  <bmaurer@users.sourceforge.net>

	* SiteMap.cs (Init): implement a hack that doesnt need the config
	stuff. Should do that later.
	* SiteMapNodeCollection (OnValidate): Fix recursion.
	* SiteMapProvider.cs: We dont implement some culture stuff work
	around it. Fix typo.
	* XmlSiteMapProvider.cs: Added.
	
2003-11-07 Ben Maurer  <bmaurer@users.sourceforge.net>

	* ISiteMapProvider.cs:
	* SiteMap.cs:
	* SiteMapNode.cs:
	* SiteMapNodeCollection.cs:
	* SiteMapProvider.cs:
	* SiteMapProviderCollection.cs: V2 sitemap related stuff.

2003-11-07  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: don't attempt to read more bytes than specified
	content length.

2003-11-05  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs:
	* HttpResponse.cs:
	* HttpUtility.cs:
	* HttpValueCollection.cs: encoding fixes/updates.

	* HttpWriter.cs: when updating the encoding, flush the existing stream.
	Encoding updates.

2003-11-04 Ben Maurer  <bmaurer@users.sourceforge.net>

	* HttpContext.cs (IsCustomErrorEnabled): dont throw exception, just
	return false (which makes sense, as the custom errors *arent* enabled;
	ie they dont work.
	* HttpResponseStream.cs: you actually can write with len = 0

2003-11-03 Jackson Harper <jackson@ximian.com>

	* HttpResponse.cs (ContentEncoding): Throw
	ArgumentNullException. Patch by Yaron Shkop.
	
2003-10-30  Atsushi Enomoto <ginga@kit.hi-ho.ne.jp>

	* HttpMultipartContentParser.cs : Quick fix for cygwin build. 
	  CSC complains that constant char cannot be casted as byte.

2003-10-22  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: added AssemblyLocation property.

2003-10-18  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs: use NoParamsInvoker.
	* HttpRequest.cs: support request filters.
	* HttpRequestStream.cs: mono-stylized and added new Set method.

	* NoParamsInvoker.cs: proxy class to invoke user-provided methods
	without parameters that are invoked by EventHandlers.

2003-10-13  Lluis Sanchez Gual <lluis@ximian.com>

	* HttpResponse.cs: Changed harcoded switch to en-US culture to a switch
	  to invariant culture.

2003-10-11  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs:
	* HttpServerUtility.cs: change the response writer in Execute. Thanks
	to Rich Alimi <rich@velvetsea.net> for noticing this.

2003-10-11  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs: support for wiring up events without
	parameters.

2003-10-06  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpUtility.cs: small memory usage reduction.

2003-10-01  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: pass the Uri, not the file path to
	when looking for a handler.

2003-09-21  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: small fix needed when reading big POST data.

2003-09-04  Lluis Sanchez Gual <lluis@ximian.com>

	* HttpRequest.cs: Url property: use GetLocalAddress() to get the address
	  (this will get the address from the request headers).

2003-09-04  Lluis Sanchez Gual <lluis@ximian.com>

	* HttpServerUtility.cs: In Transfer(), preserve the query string if
	  told to do so.

2003-08-29  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: ensure we do all the EndRequest steps. Don't
	filter the output on error.
	
	* HttpResponse.cs: modified DoFilter to allow bypassing filtering.

2003-08-27  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: when the request is completed or an
	error happens, execute all the delegates attached to EndRequest, not
	only the last one. This makes xsp/test/authtest work again.
	
	* HttpMethodNotAllowedHandler.cs: fixed description for http
	status code.

2003-08-22  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: quick way of checking that the path is within the
	root for the application. Thanks to Johannes for reporting.
	
	* HttpRuntime.cs: use the status code from teh exception when it'ss a
	HttpException.

	* StaticFileHandler.cs: forbidden is 403.

2003-08-20  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpServerUtility.cs: fixed path and query. Path by Rich Alimi
	<rich@velvetsea.net>.

2003-08-19  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpException.cs: make the unhandled error more like the MS one.
	* HttpRuntime.cs: set a 500 error code on unhandled exceptions.

2003-08-19  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: flush headers when the body length is 0.
	* StaticFileHandler.cs: added If-Modified-Since handling patch slightly
	modified from the original by Piers Haken <piersh@friskit.com>.

2003-08-14  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: another patch from totte and me. This one prevents
	writing output if the client have disconnected and filters the data
	when there's a non-final Flush in the middle of the process.

2003-08-12  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: fixed typos. Closes bug #44197.

2003-08-12  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs:
	* HttpApplicationFactory.cs: fix duplicate application OnStart events.

	Patch by Patrik Torstensson.

2003-08-11  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs: use the correct Delegate.CreateDelegate
	overload. The previous one only admits static methods.

2003-08-01  Andreas Nahr <ClassDevelopment@A-SoftTech.com>

	* ProcessModelInfo.cs: Fixed signature

2003-07-30  Andreas Nahr <ClassDevelopment@A-SoftTech.com>

	* WebCategoryAttribute.cs: Implemented localization
	* WebSysDescriptionAttribute.cs: Implemented localization

2003-07-23  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRuntime.cs: also clear the headers that may have been set upon
	error processing the request.

2003-07-23  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponseStreamProxy.cs: reformatted. Fixed infinite recursion in
	Write method.

	* HttpWriter.cs: flush the filter after writing.

2003-07-22  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpWriter.cs: avoid duplicating the MemoryStream byte buffer.

2003-07-08  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpContext.cs: Session doesn't have a setter.

	* HttpResponse.cs: Request is private.

2003-07-03  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: fixed Headers property. It was getting known headers
	values instead of known headers names.

2003-07-01  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: prevent nullref if an error happens before context
	is set.
	* HttpException.cs: small fix in the stack trace sent.
	* HttpUtility.cs: the lock is not needed.

2003-06-30  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: added REMOTE_PORT.
	* HttpValueCollection.cs: fixed bug #45490.

2003-05-13  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs:
	* HttpApplicationFactory.cs: fire application start and session
	start/end events.

2003-05-06  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpException.cs: encode as HTML the inner exception that
	is appended as a comment at the end of error pages.

2003-05-03  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpWriter.cs: don't do anything in Flush. Fixes #42249.

2003-05-01  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HtmlizedException.cs: added more virtual methods.

	* HttpException.cs:  some work on the output when there's a source
	file present.

2003-04-30  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HtmlizedException.cs: simplified to cope with the new interface.

	* HttpApplicationFactory.cs: use the application file parser to get the 
	application Type.
	
	* HttpException.cs: small changes. Needs some more work on
	ParseExceptions.
	
2003-03-25  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: fixed Url property.

2003-03-24  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HtmlizedException.cs:
	* HttpException.cs: display the correct line number in error messages.

2003-03-22  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpCachePolicy.cs: implemented all TODOs.
	* HttpRequestStream.cs: make it internal.

2003-03-18  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpContext.cs: implemented RewritePath in other way.
	* HttpRequest.cs: removed SetPhysicalPath and added SetForm.
	* HttpServerUtility.cs: implemented Transfer (string, bool).

2003-03-16  Daniel Lopez Ridruejo <daniel @ rawbyte.com>
	* HttpContext.cs : Implemented RewritePath
	* HttpRequest.cs : Added internal function SetPhysicalPath

2003-03-14  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpServerUtility.cs: implemented Transfer ().

2003-03-13  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRuntime.cs: Cache no longer have a Dispose method.

	* HttpServerUtility.cs: removed MonoTODO.

2003-03-03  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpHelper.cs: store the values in an ArrayList to get them in correct
	order.

2003-02-17  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs: Global.asax takes precedence over
	global.asax if it exists.

	* HttpRequest.cs: use allowCrossAppMapping in MapPath.

2003-02-17  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: CreateHttpHandler is now internal.

	* HttpRequest.cs: allow setting QueryStringRaw, which
	invalidates the data obtained from the previous value. Added internal
	SetFilePath method.

	* HttpServerUtility.cs: implemented Execute and GetLastError.

2003-02-17  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpServerUtility.cs: style.

2003-02-13  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: only execute the EndRequest step on error
	condition or request marked as completed. This prevent page events from
	being called when, for example, the url authorization module forbids
	the request.

2003-02-12  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: implemented the indexer.

2003-02-11  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HtmlizedException.cs: base class for exceptions that makes it easy to
	generate error pages.

	* HttpException.cs: improved error displaying.

	* HttpRuntime.cs: removed debugging output.

2003-02-06  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: display the error instead of hanging when we get
	any error before the last step of the request.

2003-02-04  Tim Haynes <thaynes@openlinksw.com>

	* HttpApplicationFactory.cs: fixed HttpRuntime.Close() to decrement
	instance counter.

2003-01-29  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: added BaseVirtualDir property and use it in MapPath.

2003-01-17  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: implemented CurrentExecutionFilePath.

2003-01-10  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: keep _lasterror if no context. Attach
	application events *after* modules initialization (if not, User is not
	set when the user handler is called).
	
	* HttpApplicationFactory.cs: made all methods related to
	AttachEvents static. I will fix OnStart/OnEnd for application and
	session later.
	
	* HttpRequest.cs: don't initialize cookies twice.

2003-01-10  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs:
	(ApplyAppPathModifiers): return the root directory for "".

2003-01-08  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpUtility.cs: fixed HtmlDecode to avoid ArgumentOutOfRangeException.

2003-01-04  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: added new state to handle default authentication.

2003-01-03  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpContext.cs: removed hack to get the User.

2003-01-03  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpUtility.cs: fixed bug #36038. Thanks to juancri@tagnet.org for
	reporting the bug and how to fix it.

2002-12-20  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpCookie.cs: send 'expires' in the header.

2002-12-19  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpValueCollection.cs: patch from Botjan Vizin 
	<bostjan.vizin@siol.net> that implements ToString (bool).

2002-12-18  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs: add the context as parameter when building
	the application Type.
	
	* HttpCookie.cs: new internal constructor.
	* HttpCookieCollection.cs: new internal method to make a cookie expire.

	* HttpRequest.cs: MapPath fixes.
	* HttpResponse.cs: implemented ApplyAppPathModifier.
	* HttpRuntime.cs: fixed typo in AppDomainAppVirtualPath.

2002-12-17  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpContext.cs: hack to create a default user when there's no one.
	Implemented GetConfig (string).

	* HttpRequest.cs: fixes to MapPath (string).

2002-12-12  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRuntime.cs: avoid nulls and exception when getting resource
	format strings.

	* StaticFileHandler.cs: added file name to error message.

2002-12-05  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: avoid sending chunked content for HTTP/1.1.

2002-12-02  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs: get the events from the application class,
	fire Application/Session Start/End and add the others as application
	events.

2002-11-30  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs: compile global.asax file if it exists.

2002-11-27  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: provide a default Browser until we detect it.
	* HttpResponse.cs:
	(End): do not close the connection here.
	(Flush (bool)): send the headers when, for example, Redirect () is
	called.

2002-11-12  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpException.cs: simple error output.

2002-11-12  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: style.
	* HttpException.cs: style.
	* HttpRuntime.cs: only flush the response if there are no errors.
	Otherwise, write an error output.
	* HttpWriter.cs: change Unicode to UTF8.

2002-11-09  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: don't begin the request using ExecuteNextAsync
	(it fails to work on NetServ).

	* HttpWorkerRequest.cs: typo.

2002-11-07  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpValueCollection.cs: the value may contain trailing '=' as it is
	UrlEncoded. Don't split name=value based on '='.

2002-11-02  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpCookie.cs: made GetCookieHeader internal.

	* HttpRequest.cs: get cookies from request.

	* HttpResponse.cs: send cookies. Implemented
	AddFileDependencies (). Added check for _Writer == null in Flush
	(Patrik ;-). Clear the content if HEAD or SupressContent == true.
	Removed redirect hack used in old server.

2002-10-31  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: fixed GetRawContent (). Now it only tries to read at
	most ContentLength bytes.

	* HttpResponse.cs: now it sends the headers. Added
	X-Powered-By header :-).

	* HttpRuntime.cs: fixed typo.

	* HttpValueCollection.cs: cosmetic changes.

2002-10-27  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: reenabled a few lines of code
	(ThreadPool already fixed). 
	
	* HttpRequest.cs:
	* HttpResponse.cs:
	* HttpUtility.cs:
	* HttpValueCollection.cs:
	* HttpWriter.cs: Use WebEncoding.Encoding.

2002-10-25  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpWriter.cs: changed encoding of the writer from Unicode to UTF8.
	This fixes sending bytes and allows mixing byte with chars.

2002-10-25  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: implemented WriteFile methods.
	* MimeTypes.cs: removed duplicated entries.

2002-10-24  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: don't throw exception in a couple of
	methods not yet implemented.

2002-10-08  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: fixed type and handle factories when creating
	IHttpHandler for a request.

2002-10-08  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: use handlers from configuration.
	* HttpContext.cs: get handlers from ConfigurationSettings.

2002-10-02  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpMethodNotAllowedHandler.cs:
	* HttpRuntime.cs:
	* StaticFileHandler.cs: Modified file.

	* HttpUtility.cs: implemented all missing methods.


2002-09-30  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* System.Web/HttpApplication.cs: use the static file handler.
	* System.Web/HttpForbiddenHandler.cs: handler to forbid access.
	* System.Web/HttpMethodNotAllowedHandler.cs: handler for method not
	allowed.
	
	* System.Web/HttpUtility.cs: finished all UrlDecode methods.
	* System.Web/MimeTypes.cs: map from file extension to MIME type.
	* System.Web/StaticFileHandler.cs: serves static files

2002-09-28  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* System.Web/HttpApplication.cs:
	* System.Web/HttpApplicationFactory.cs:
	* System.Web/HttpRequest.cs:
	* System.Web/HttpRuntime.cs: we are now able to compile pages and use
	HttpApplication, HttpRuntime and SimpleWorkerRequest.

2002-09-25  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: added some missing methods.
	* HttpApplicationFactory.cs: get event handlers for the application.
	* HttpAsyncResult.cs: little fixes.
	* HttpRequest.cs: make Encoding work even with no worker request.

2002-08-26  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpWorkerRequest.cs: mcs doesn't go crazy. It's just me, that forgot
	to add HttpMapPath to the list file...

2002-08-26  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpWorkerRequest.cs: fixes compilation with mcs. I will add a bug
	report when i get a test case.

2002-08-26  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplicationFactory.cs:
	* HttpCachePolicy.cs:
	* HttpResponseHeader.cs:
	* HttpResponseStream.cs:
	* HttpResponseStreamProxy.cs:
	* HttpValueCollection.cs: misc. fixes based on class status page.

	* IHttpMapPath.cs: New file.

	* HttpRequest.cs: implemented ContentEncoding.
	* HttpWorkerRequest.cs: mono-stylized and implemented
	SendResponseFromMemory.

2002-08-18  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpContext.cs: reformatted.
	* HttpStaticObjectsCollection.cs: implemented GetEnumertor, CopyTo and
	the indexer.

2002-08-05  Patrik Torstensson <ptorsten@hotmail.com>

	* HttpApplication.cs: Implemented a state machine to allow handling of
	HttpModules and HttpHandlers. Implementation of async handlers. 
								 
	* HttpApplicationFactory.cs: Factory for creating HttpApplication
	instances, including caching.
	
	* HttpRuntime.cs: Usage of the new HttpApplicationFactory to get a
	application instance to execute requests in and implementation of 
	request execution (still no request queue). 
							 
	* HttpAsyncResult.cs: New file to handle async module results.						
							 
	* HttpRequest.cs: Change signature of Dispose
	* HttpResponse.cs: new internal method allowing filtering to happen
	during the request flow in the state machine.

2002-07-28  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs: events were not being initialized.

2002-07-25  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* ProcessModelInfo.cs: fixed compilation.

2002-07-25  Tim Coleman <tim@timcoleman.com>
	* ProcessModelInfo.cs:
		New class added
	* HttpParseException.cs:
	* HttpCompileException.cs:
	* HttpUnhandledException.cs:
		Internal constructors added to these

2002-07-24  Tim Coleman <tim@timcoleman.com>
	* ProcessInfo.cs: 
		Fix constructor, reference to shutdownreason.

2002-07-24  Tim Coleman <tim@timcoleman.com>
	* HttpCachePolicy.cs:
		Added stubbs to this class.
	* HttpCacheability.cs:
	* HttpCacheRevalidation.cs:
	* HttpValidationStatus.cs:
	* ProcessShutdownReason.cs:
	* ProcessStatus.cs:
	* TraceMode.cs:
		Reorder the enumerations (and in some cases make
		one-based) in order to agree with the .NET 
		implementation, based on the class status page.
	* ProcessInfo.cs:
		Implementation of this class.

2002-07-23  Tim Coleman <tim@timcoleman.com>
	* HttpCompileException.cs:
	* HttpParseException.cs:
	* HttpUnhandledException.cs:
		New stubbs created.
	* HttpApplication.cs:
	* HttpBrowserCapabilities.cs:
		Added missing methods stubbs and attributes based
		on the class status page.  Also reformatted some
		source for consistency.

2002-07-23  Tim Coleman <tim@timcoleman.com>
	* HttpUtility.cs: Moved entities hashtable into main
		class as a static object, so we don't instantiate
		a new one every time.  Also put the hashtable
		building into a lock block.

2002-07-22  Tim Coleman <tim@timcoleman.com>
	* HttpUtility.cs: Cleanup of the code, implementation
		of HtmlDecode/HtmlEncode functions

2002-07-14  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpResponse.cs: quick&dirty hack to make redirection work. Should
	be out of there once we have SimpleWorkerRequest.

2002-07-13  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpUtility.cs: little typo, big headache.

2002-07-10  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRuntime.cs: don't throw NotImplemented in a couple of methods.

2002-06-30  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* System.Web/HttpResponse.cs: 

	Fixes based on class status page:
	
		- Add attributes (DefaultEvent, ParseChildren).
		- Fix declarations.
		- Explicitly implement some interfaces (IPostBackDataHandler
		and IPostBackEventHandler).
		- Implemented some missing methods.

2002-06-29  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpContext.cs:
	(Session): return null instead of throwing an exception.

	* HttpRequest.cs:
	(HttpMethod): return RequestType if not set.
	(GetRawContent): return QueryString if we don't have a
	HttpWorkerRequest.

	* HttpUtility.cs: fixed Decode and Encode.

2002-06-25  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpApplication.cs:
	* HttpContext.cs: added System.Web.SessionState namespace.

	* HttpSessionState.cs: removed. It is under
	System.Web.SessionState.

2002-06-10  Duncan Mak  <duncan@ximian.com>

	* HttpBrowserCapabilities.cs (BackgroundSounds): Fixed typo.

2002-06-04  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpRequest.cs: implemented Browser property.

2002-06-03  Gonzalo Paniagua Javier <gonzalo@ximian.com>

	* HttpBrowserCapabilities.cs: stubbed out.

2002-05-18  Miguel de Icaza  <miguel@ximian.com>

	* HttpRuntime.cs: Reformat file.

2002-05-07  Duncan Mak  <duncan@ximian.com>

	* HttpBrowserCapabilities.cs: Added, replacing
	HttpBrowserCapabilites because of typo.

	* HttpBrowserCapabilites.cs: Removed, replaced by above.

	* HttpRequest.cs (Browser): Fixed typo.

2002-04-12  Patrik Torstensson <patrik.torstensson@labs2.com>

	* HttpApplication.cs: Minor updates
	* HttpApplicationState.cs: Ready.
	* HttpClientCertificate.cs: Signature updates
	* HttpValueCollection.cs: ready
	* HttpStaticObjectsCollection.cs: ready
	* HttpResponseHeader.cs: made internal only
	* HttpResponse.cs: Signature updates
	* HttpPostedFile.cs: ready
	* HttpCacheVaryByHeaders.cs: ready (except communication to policy)
	* HttpCacheVaryByParams.cs: ready (except communication to policy)
	
	System.Web is now over 60% ready.. 

2002-04-11  Patrik Torstensson <patrik.torstensson@labs2.com>

	* HttpException.cs: 95% ready, only windows dependent code left
	* HttpFileCollection.cs: Finished.
	* HttpRequest.cs: Minor fixes and fixed signature problems
	* HttpResponse.cs: Implementation of missing methods and signature problems
	* HttpResponseHeader.cs: Fixed signature problems
	* HttpRuntime.cs: Fixed signature problems
	* HttpServerUtility.cs: Added support for HttpApplication
	* HttpSessionState.cs: Fixed signature issues
	* HttpUtility.cs: fixed signature issues
	* HttpValueCollection.cs: Support for cookie parsing and fixed signature issues
	* HttpWorkerRequest.cs: Fixed small signature issue
	* HttpWriter.cs: Fixed signature issue
	* HttpApplication.cs: Basic implementation
	* HttpApplicationState.cs: Small fixes to support major change comming up
	* HttpBrowserCapabilities.cs: Added Type method
	* HttpClientCertificate.cs: Almost ready, needs to parse certificate.
	* HttpContext.cs: Fixed signature issues and added last methods.
	* HttpCookie.cs: Full implementation
	* HttpCookieCollection.cs: Full implementation
	* TraceContext.cs: Methods implemented.
	* HttpPostedFile.cs: Placeholder
	* HttpStaticObjectsCollection.cs: Placeholder
	* HttpModuleCollection.cs: Ready, will be used during the major revamp.
	
	* Fixed a number of other small signature problems also (class status page)
	
	
2002-04-10  Patrik Torstensson <patrik.torstensson@labs2.com>

    * HttpWorkerRequest.EndOfSendNotification.cs Removed (included in WorkerRequest)
    * Checkin of all new files (noted in last changenote)

2002-04-10  Patrik Torstensson <patrik.torstensson@labs2.com>

    * HttpContext.cs: First implementation (basic support, few methods left to impl)
    * HttpException.cs: Partial implementation (basic support)
    * HttpHelper.cs: Header parse helper, used by runtime (non public)
    * HttpRequest.cs: Implementation (all methods there, not all fully impl)
    * HttpRequestStream.cs: Full implementation
    * HttpResponse.cs: Partial implementation(almost all methods)
    * HttpResponseHeader.cs: Header helper
    * HttpResponseStream.cs: Full implementation - Response stream support
    * HttpResponseStreamProxy.cs: Implementation - filter support
    * HttpRuntime.cs: Rewrite to support one IHttpModule (use for testing the runtime)
	* HttpServerUtility.cs: Implemented usage of HttpContext for methods
	                        and moved encoding functions to HttpUtility.

    * HttpUtility.cs: Added encoding/decoding functions from HttpServerUtility and
                      added the Attribute encoding functions.

    * HttpValueCollection.cs: Implementation.
    * HttpWorkerRequest.cs: Rewrite and implementation of all methods (ready)
    * HttpWriter.cs: Implementation (with filter support)    

    * HttpFileCollection: Added dummy class (placeholder)
    * HttpApplication.cs: Added dummy class (placeholder)
    * HttpApplicationState.cs: Added dummy class (placeholder)
    * HttpBrowserCapabilities.cs: Added dummy class (placeholder)
    * HtttpCachePolicy.cs: Added dummy class (placeholder)
    * HttpClientCertificate.cs: Added dummy class (placeholder)
    * HttpSessionState.cs: Added dummy class (placeholder)
    * TraceContext.cs: Added dummy class (placeholder)
    

2002/04/10  Nick Drochak <ndrochak@gol.com>

	* HttpServerUtility.cs: Fix build breaker.

2002-03-28  Wictor Wiln  <wictor@iBizkit.se>

	* HttpServerUtils.cs : Added some more functionality
	
2002-03-28  Martin Baulig  <martin@gnome.org>

	* HttpServerUtils.cs (UrlDecode): You cannot implicitly cast a
	char to a string, use ToString() instead.

2002-03-16  Gaurav Vaish  <gavish@iitk.ac.in>

	* WebCategoryAttribute.cs
	                       : Added private attribute.

2002-03-16  Gaurav Vaish  <gavish@iitk.ac.in>

	* HttpRuntime.cs       : Stubbed methods for
	          FormatStringResource(...) in agreement with the various
	          overloads available at String.Format(...)

2002-01-08  Gaurav Vaish  <gavish@iitk.ac.in>

	* TODOAttribute.cs     : Added, as an internal class to the assembly

2002-01-03  Nick Drochak  <ndrochak@gol.com>

	* HttpRuntime.cs: remove uneeded exception variable from catch and
	initialize remaining instance members to avoid compile warnings

2002-01-02  Nick Drochak  <ndrochak@gol.com>

	* HttpRuntime.cs: fix spelling error/variable name change.

2001-12-18  Gaurav Vaish <gvaish@iitk.ac.in>

        * HttpRuntime.cs       : Initial implementation

2001-08-29  Bob Smith  <bob@thestuff.net>

        * HttpWorkerRequest.cs: Partial Implementation.

2001-08-16  Bob Smith  <bob@thestuff.net>

         * HttpCookieCollection.cs, HttpCookie.cs: Bug fixes.

2001-08-09  Bob Smith  <bob@thestuff.net>

         * BeginEventHandler.cs: Implemented.
         * EndEventHandler.cs: Implemented.
         * HttpCacheability.cs: Implemented.
         * HttpCacheRevalidation.cs: Implemented.
         * HttpCacheValidateHandler.cs: Implemented.
         * HttpCookieCollection.cs: Implemented.
         * HttpCookie.cs: Implemented.
         * HttpValidationStatus.cs: Implemented.
         * HttpWorkerRequest.EndOfSendNotification.cs: Implemented.
         * IHttpAsyncHandler.cs: Implemented.
         * IHttpHandler.cs: Implemented.
         * IHttpHandlerFactory.cs: Implemented.
         * IHttpModule.cs: Implemented.
         * ProcessShutdownReason.cs: Implemented.
         * ProcessStatus.cs: Implemented.
         * TraceMode.cs: Implemented.
